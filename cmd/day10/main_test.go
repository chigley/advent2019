package main_test

import (
	"os"
	"testing"

	"github.com/chigley/advent2019"
	day10 "github.com/chigley/advent2019/cmd/day10"
	"github.com/stretchr/testify/assert"
)

var part1Tests = []struct {
	input  []string
	output int
}{
	{
		[]string{
			".#..#",
			".....",
			"#####",
			"....#",
			"...##",
		},
		8,
	},
	{
		[]string{
			"......#.#.",
			"#..#.#....",
			"..#######.",
			".#.#.###..",
			".#..#.....",
			"..#....#.#",
			"#..#....#.",
			".##.#..###",
			"##...#..#.",
			".#....####",
		},
		33,
	},
	{
		[]string{
			"#.#...#.#.",
			".###....#.",
			".#....#...",
			"##.#.#.#.#",
			"....#.#.#.",
			".##..###.#",
			"..#...##..",
			"..##....##",
			"......#...",
			".####.###.",
		},
		35,
	},
	{
		[]string{
			".#..#..###",
			"####.###.#",
			"....###.#.",
			"..###.##.#",
			"##.##.#.#.",
			"....###..#",
			"..#.#..#.#",
			"#..#.#.###",
			".##...##.#",
			".....#.#..",
		},
		41,
	},
	{
		[]string{
			".#..##.###...#######",
			"##.############..##.",
			".#.######.########.#",
			".###.#######.####.#.",
			"#####.##.#.##.###.##",
			"..#####..#.#########",
			"####################",
			"#.####....###.#.#.##",
			"##.#################",
			"#####.##.###..####..",
			"..######..##.#######",
			"####.##.####...##..#",
			".#####..#.######.###",
			"##...#.##########...",
			"#.##########.#######",
			".####.#.###.###.#.##",
			"....##.##.###..#####",
			".#.#.###########.###",
			"#.#.#.#####.####.###",
			"###.##.####.##.#..##",
		},
		210,
	},
}

func TestDay10(t *testing.T) {
	input, err := os.Open("testdata/input")
	if err != nil {
		t.Fatal(err)
	}
	defer input.Close()

	lines, err := advent2019.ReadStrings(input)
	if err != nil {
		t.Fatal(err)
	}

	_, part1 := day10.Part1(day10.Asteroids(lines))
	assert.Equal(t, 280, part1)
}

func TestPart1(t *testing.T) {
	for _, tt := range part1Tests {
		_, output := day10.Part1(day10.Asteroids(tt.input))
		assert.Equal(t, tt.output, output)
	}
}
